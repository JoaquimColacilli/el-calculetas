<div class="flex-1 flex flex-col">
  <header
    [ngStyle]="{ 'background-color': navbarBackgroundColor }"
    class="flex items-center justify-between p-6 shadow-sm"
  >
    <div class="flex items-center space-x-3">
      <h1 class="text-2xl font-bold text-gray-700">{{ pageTitle }}</h1>

      <div
        class="flex items-center space-x-2 text-gray-600 text-sm border-l pl-4"
      >
        <fa-icon
          [icon]="['fas', 'calendar-days']"
          class="text-blue-500"
        ></fa-icon>
        <span class="font-medium">{{ currentDateTime }}</span>
      </div>

      <div
        class="flex items-center space-x-3 text-gray-700 text-md border-l pl-4"
      >
        <fa-icon [icon]="['fas', 'code']" class="text-blue-500"></fa-icon>
        <span class="font-semibold">Versión: {{ version }}</span>
      </div>
    </div>

    <div class="flex items-center space-x-3 relative px-4">
      <img
        [src]="
          userData?.profilePicture ||
          userData?.photoURL ||
          'profile_default.png'
        "
        alt="Profile Picture"
        class="w-10 h-10 rounded-full object-cover"
      />

      <div class="flex flex-col leading-tight relative">
        <div class="flex items-center justify-between">
          <span class="text-gray-800 font-medium">{{
            userData?.username || userData?.displayName
          }}</span>

          <fa-icon
            [icon]="['fas', 'chevron-down']"
            class="text-gray-500 cursor-pointer icon-menu-toggle"
            (click)="toggleUserMenu()"
          ></fa-icon>
        </div>

        <span class="text-sm text-gray-500 truncate">
          {{ userData?.email || userData?.username }}
        </span>

        <div
          *ngIf="isUserMenuOpen || isClosing"
          class="absolute mt-6 w-48 bg-white border rounded-lg shadow-lg py-2 transition-transform duration-300 ease-out origin-top-right scale-95 user-menu z-10"
          [ngClass]="{
            'animate-fadeIn': isUserMenuOpen && !isClosing,
            'animate-fadeOut': isClosing
          }"
          (animationend)="onAnimationEnd()"
        >
          <button
            class="flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200"
            (click)="viewProfile()"
          >
            <fa-icon
              [icon]="['fas', 'user']"
              class="mr-2 text-gray-500"
            ></fa-icon>
            Ver Perfil
          </button>

          <button
            class="flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200"
            (click)="openSwitchAccountModal()"
          >
            <fa-icon
              [icon]="['fas', 'exchange-alt']"
              class="mr-2 text-gray-500"
            ></fa-icon>
            Cambiar Cuenta
          </button>
          <button
            class="flex items-center w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-100 transition-colors duration-200"
            (click)="logout()"
          >
            <fa-icon
              [icon]="['fas', 'sign-out-alt']"
              class="mr-2 text-red-500"
            ></fa-icon>
            Cerrar Sesión
          </button>
        </div>
      </div>
    </div>
  </header>
</div>
